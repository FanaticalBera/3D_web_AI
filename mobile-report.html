<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°œ ë¶„ì„ ë¦¬í¬íŠ¸ - ëª¨ë°”ì¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .measurement-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .analysis-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .recommendation-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            body {
                font-size: 12px !important;
            }
            
            .card-shadow {
                box-shadow: none !important;
                border: 1px solid #e5e7eb !important;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading-screen" class="fixed inset-0 gradient-bg flex items-center justify-center z-50">
        <div class="text-center text-white">
            <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-4"></div>
            <h2 class="text-xl font-semibold">ë¦¬í¬íŠ¸ ë¡œë”© ì¤‘...</h2>
            <p class="mt-2 opacity-80">ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤</p>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div id="main-content" class="hidden">
        <!-- í—¤ë” -->
        <header class="gradient-bg text-white py-6 px-4">
            <div class="container mx-auto text-center">
                <h1 class="text-3xl font-bold mb-2">ğŸ‘£ 3D ë°œ ë¶„ì„ ë¦¬í¬íŠ¸</h1>
                <p class="opacity-90" id="analysis-date">ë¶„ì„ ì™„ë£Œ</p>
            </div>
        </header>

        <!-- ì½˜í…ì¸  ì˜ì—­ -->
        <div class="container mx-auto p-4 -mt-4">
            <!-- íŒŒì¼ ì •ë³´ ì¹´ë“œ -->
            <div class="bg-white rounded-xl card-shadow p-6 mb-6">
                <div class="flex items-center mb-4">
                    <div class="bg-blue-100 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">íŒŒì¼ ì •ë³´</h2>
                        <p class="text-gray-600">ì—…ë¡œë“œëœ 3D ëª¨ë¸ ì •ë³´</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-3">
                    <div class="flex justify-between items-center py-2 border-b border-gray-100">
                        <span class="text-gray-600">íŒŒì¼ëª…</span>
                        <span class="font-semibold text-gray-800" id="file-name">-</span>
                    </div>
                    <div class="flex justify-between items-center py-2">
                        <span class="text-gray-600">ë¶„ì„ ì™„ë£Œ</span>
                        <span class="font-semibold text-gray-800" id="analysis-time">-</span>
                    </div>
                </div>
            </div>

            <!-- ì¸¡ì • ë°ì´í„° ì¹´ë“œ -->
            <div class="measurement-card rounded-xl card-shadow p-6 mb-6 text-white">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold">ì •ë°€ ì¸¡ì • ë°ì´í„°</h2>
                        <p class="opacity-90">3D ìŠ¤ìº” ê¸°ë°˜ ì •í™•í•œ ì¸¡ì • ê²°ê³¼</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-4">
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm opacity-90">ğŸ‘£ ë°œ ê¸¸ì´ (ì¡±ì¥)</span>
                            <span class="text-2xl font-bold" id="foot-length">- mm</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full transition-all duration-1000" id="length-bar"></div>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm opacity-90">â†”ï¸ ë°œë³¼ ë„ˆë¹„ (ì¡±í­)</span>
                            <span class="text-2xl font-bold" id="foot-width">- mm</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full transition-all duration-1000" id="width-bar"></div>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm opacity-90">â†•ï¸ ë°œë“± ë†’ì´</span>
                            <span class="text-2xl font-bold" id="foot-height">- mm</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full transition-all duration-1000" id="height-bar"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-white bg-opacity-10 rounded-lg">
                    <div class="flex items-center justify-between">
                        <span class="text-sm opacity-90">ì¸¡ì • ì‹ ë¢°ë„</span>
                        <span class="font-semibold" id="confidence-level">ë†’ìŒ</span>
                    </div>
                </div>
            </div>

            <!-- ë¹„ìœ¨ ë¶„ì„ ì¹´ë“œ -->
            <div class="bg-white rounded-xl card-shadow p-6 mb-6">
                <div class="flex items-center mb-4">
                    <div class="bg-purple-100 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">ë¹„ìœ¨ ë¶„ì„</h2>
                        <p class="text-gray-600">ë°œì˜ ê· í˜•ê³¼ ë¹„ë¡€ ë¶„ì„</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-purple-600 mb-2" id="length-width-ratio">2.4</div>
                        <div class="text-sm text-gray-600">ê¸¸ì´/ë„ˆë¹„ ë¹„ìœ¨</div>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-purple-600 mb-2" id="height-length-ratio">20%</div>
                        <div class="text-sm text-gray-600">ë†’ì´/ê¸¸ì´ ë¹„ìœ¨</div>
                    </div>
                </div>
            </div>

            <!-- ë°œ ìœ í˜• ë¶„ì„ ì¹´ë“œ -->
            <div class="analysis-card rounded-xl card-shadow p-6 mb-6 text-white">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold">ë°œ ìœ í˜• ì¢…í•© ë¶„ì„</h2>
                        <p class="opacity-90">AI ê¸°ë°˜ ë§ì¶¤í˜• ë°œ ìœ í˜• ë¶„ì„</p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm opacity-90">ë°œ í˜•íƒœ</span>
                            <span class="font-bold text-lg" id="foot-type">í‘œì¤€í˜•</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm opacity-90">ì•„ì¹˜ ìœ í˜•</span>
                            <span class="font-bold text-lg" id="arch-type">ì •ìƒ ì•„ì¹˜</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <p class="text-sm opacity-90 mb-2">íŠ¹ì§•</p>
                        <p id="foot-description">ê· í˜•ì¡íŒ ë¹„ë¡€ë¥¼ ê°€ì§„ í‘œì¤€ì ì¸ ë°œ í˜•íƒœì…ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>

            <!-- ì¶”ì²œ ì‚¬í•­ ì¹´ë“œ -->
            <div class="recommendation-card rounded-xl card-shadow p-6 mb-6 text-white">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold">ë§ì¶¤í˜• ì‹ ë°œ ì¶”ì²œ</h2>
                        <p class="opacity-90">ë°œ ìœ í˜•ì— ë”°ë¥¸ ì „ë¬¸ê°€ ì¶”ì²œì‚¬í•­</p>
                    </div>
                </div>
                <div id="recommendations-list" class="space-y-3">
                    <!-- ì¶”ì²œì‚¬í•­ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì•¡ì…˜ ë²„íŠ¼ -->
            <div class="no-print space-y-3 mb-8">
                <button onclick="downloadPDF()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    ğŸ“„ PDF ë‹¤ìš´ë¡œë“œ
                </button>
                <button onclick="shareReport()" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                    </svg>
                    ğŸ“± ë¦¬í¬íŠ¸ ê³µìœ 
                </button>
                <button onclick="window.print()" class="w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°
                </button>
            </div>

            <!-- í‘¸í„° -->
            <footer class="text-center text-gray-500 text-sm py-6 border-t">
                <p>Â© 2024 3D ë°œ ë¶„ì„ê¸° | ì •ë°€ ì¸¡ì • ì‹œìŠ¤í…œ</p>
                <p class="mt-1">ì´ ë¦¬í¬íŠ¸ëŠ” 3D ìŠ¤ìº” ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            </footer>
        </div>
    </div>

    <!-- jsPDF ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        let reportData = null;

        // í˜ì´ì§€ ë¡œë“œì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', () => {
            loadReportData();
        });

        function loadReportData() {
            // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë°ì´í„° ì¶”ì¶œ
            const urlParams = new URLSearchParams(window.location.search);
            const encodedData = urlParams.get('data');
            
            if (encodedData) {
                try {
                    const jsonData = decodeURIComponent(escape(atob(encodedData)));
                    reportData = JSON.parse(jsonData);
                    displayReport(reportData);
                } catch (error) {
                    console.error('ë¦¬í¬íŠ¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    showError('ë¦¬í¬íŠ¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } else {
                showError('ë¦¬í¬íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. QR ì½”ë“œë¥¼ ë‹¤ì‹œ ìŠ¤ìº”í•´ì£¼ì„¸ìš”.');
            }
        }

        function displayReport(data) {
            setTimeout(() => {
                // ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
                document.getElementById('loading-screen').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');

                // íŒŒì¼ ì •ë³´ í‘œì‹œ
                document.getElementById('file-name').textContent = data.fileName || 'Unknown';
                document.getElementById('analysis-time').textContent = new Date(data.analysisDate).toLocaleString('ko-KR');
                document.getElementById('analysis-date').textContent = 
                    `${new Date(data.analysisDate).toLocaleDateString('ko-KR')} ë¶„ì„ ì™„ë£Œ`;

                // ì¸¡ì • ë°ì´í„° í‘œì‹œ
                const measurements = data.measurements;
                document.getElementById('foot-length').textContent = `${measurements.length} ${measurements.unit}`;
                document.getElementById('foot-width').textContent = `${measurements.width} ${measurements.unit}`;
                document.getElementById('foot-height').textContent = `${measurements.height} ${measurements.unit}`;
                document.getElementById('confidence-level').textContent = measurements.confidence;

                // ì¸¡ì • ë°” ì• ë‹ˆë©”ì´ì…˜
                animateMeasurementBars(measurements);

                // ë¹„ìœ¨ ë¶„ì„ í‘œì‹œ
                document.getElementById('length-width-ratio').textContent = data.ratios.lengthWidth;
                document.getElementById('height-length-ratio').textContent = data.ratios.heightLength;

                // ë°œ ìœ í˜• ë¶„ì„ í‘œì‹œ
                const analysis = data.analysis;
                document.getElementById('foot-type').textContent = analysis.footType;
                document.getElementById('arch-type').textContent = analysis.archType;
                document.getElementById('foot-description').textContent = analysis.description;

                // ì¶”ì²œì‚¬í•­ í‘œì‹œ
                displayRecommendations(data.recommendations);

            }, 1500); // 1.5ì´ˆ ë¡œë”© ì‹œê°„
        }

        function animateMeasurementBars(measurements) {
            // ìµœëŒ€ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë°” ê¸¸ì´ ê³„ì‚°
            const maxLength = Math.max(
                parseFloat(measurements.length) || 0,
                parseFloat(measurements.width) || 0,
                parseFloat(measurements.height) || 0
            );

            setTimeout(() => {
                const lengthPercent = (parseFloat(measurements.length) / maxLength) * 100;
                const widthPercent = (parseFloat(measurements.width) / maxLength) * 100;
                const heightPercent = (parseFloat(measurements.height) / maxLength) * 100;

                document.getElementById('length-bar').style.width = `${lengthPercent}%`;
                document.getElementById('width-bar').style.width = `${widthPercent}%`;
                document.getElementById('height-bar').style.width = `${heightPercent}%`;
            }, 500);
        }

        function displayRecommendations(recommendations) {
            const container = document.getElementById('recommendations-list');
            container.innerHTML = '';

            recommendations.forEach((rec, index) => {
                const div = document.createElement('div');
                div.className = 'bg-white bg-opacity-10 rounded-lg p-4 transform transition-all duration-500';
                div.style.animationDelay = `${index * 200}ms`;
                div.innerHTML = `
                    <div class="flex items-start">
                        <div class="bg-white bg-opacity-20 rounded-full p-2 mr-3 mt-1">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <p class="text-sm leading-relaxed">${rec}</p>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function showError(message) {
            document.getElementById('loading-screen').classList.add('hidden');
            document.getElementById('main-content').innerHTML = `
                <div class="container mx-auto p-4 text-center">
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
                        <h2 class="text-xl font-bold mb-2">ì˜¤ë¥˜ ë°œìƒ</h2>
                        <p>${message}</p>
                    </div>
                </div>
            `;
            document.getElementById('main-content').classList.remove('hidden');
        }

        function downloadPDF() {
            if (!reportData) {
                alert('ë¦¬í¬íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // PDF ìƒì„±
            doc.setFont('helvetica');
            
            // ì œëª©
            doc.setFontSize(20);
            doc.text('3D Foot Analysis Report', 20, 30);
            
            // íŒŒì¼ ì •ë³´
            doc.setFontSize(12);
            doc.text(`File: ${reportData.fileName}`, 20, 50);
            doc.text(`Analysis Date: ${new Date(reportData.analysisDate).toLocaleDateString('ko-KR')}`, 20, 60);
            
            // ì¸¡ì • ë°ì´í„°
            doc.setFontSize(16);
            doc.text('Measurement Data', 20, 80);
            
            doc.setFontSize(12);
            const measurements = [
                `Foot Length: ${reportData.measurements.length} ${reportData.measurements.unit}`,
                `Foot Width: ${reportData.measurements.width} ${reportData.measurements.unit}`,
                `Foot Height: ${reportData.measurements.height} ${reportData.measurements.unit}`,
                `Confidence: ${reportData.measurements.confidence}`
            ];
            
            let yPos = 100;
            measurements.forEach(measurement => {
                doc.text(measurement, 20, yPos);
                yPos += 15;
            });
            
            // ë¹„ìœ¨ ë¶„ì„
            doc.setFontSize(16);
            doc.text('Ratio Analysis', 20, yPos + 10);
            yPos += 30;
            
            doc.setFontSize(12);
            doc.text(`Length/Width Ratio: ${reportData.ratios.lengthWidth}`, 20, yPos);
            doc.text(`Height/Length Ratio: ${reportData.ratios.heightLength}`, 20, yPos + 15);
            yPos += 40;
            
            // ë°œ ìœ í˜• ë¶„ì„
            doc.setFontSize(16);
            doc.text('Foot Type Analysis', 20, yPos);
            yPos += 20;
            
            doc.setFontSize(12);
            doc.text(`Foot Shape: ${reportData.analysis.footType}`, 20, yPos);
            doc.text(`Arch Type: ${reportData.analysis.archType}`, 20, yPos + 15);
            doc.text(`Description: ${reportData.analysis.description}`, 20, yPos + 30);
            yPos += 50;
            
            // ì¶”ì²œ ì‚¬í•­
            doc.setFontSize(16);
            doc.text('Recommendations', 20, yPos);
            yPos += 20;
            
            doc.setFontSize(10);
            reportData.recommendations.forEach(rec => {
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 20;
                }
                doc.text(`â€¢ ${rec}`, 20, yPos);
                yPos += 12;
            });
            
            // PDF ì €ì¥
            const fileName = `foot_analysis_mobile_${new Date().toISOString().slice(0, 10)}.pdf`;
            doc.save(fileName);
        }

        function shareReport() {
            if (navigator.share) {
                navigator.share({
                    title: '3D ë°œ ë¶„ì„ ë¦¬í¬íŠ¸',
                    text: 'ë‚´ ë°œì˜ ì •ë°€ ì¸¡ì • ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!',
                    url: window.location.href
                }).catch(console.error);
            } else {
                // í´ë°±: URL ë³µì‚¬
                navigator.clipboard.writeText(window.location.href).then(() => {
                    alert('ë¦¬í¬íŠ¸ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(() => {
                    // í´ë¦½ë³´ë“œ APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš°
                    const textArea = document.createElement('textarea');
                    textArea.value = window.location.href;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('ë¦¬í¬íŠ¸ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            }
        }

        // ì¸ì‡„ ìµœì í™”
        window.addEventListener('beforeprint', () => {
            document.body.classList.add('print-mode');
        });

        window.addEventListener('afterprint', () => {
            document.body.classList.remove('print-mode');
        });

        // PWA ê´€ë ¨ ê¸°ëŠ¥
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(registrationError => console.log('SW registration failed'));
            });
        }

        // ë‹¤í¬ëª¨ë“œ ì§€ì›
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
    </script>

</body>
</html> 