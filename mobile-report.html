<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î∞ú Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏ - Î™®Î∞îÏùº</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .measurement-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .analysis-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .recommendation-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            body {
                font-size: 12px !important;
            }
            
            .card-shadow {
                box-shadow: none !important;
                border: 1px solid #e5e7eb !important;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Î°úÎî© ÌôîÎ©¥ -->
    <div id="loading-screen" class="fixed inset-0 gradient-bg flex items-center justify-center z-50">
        <div class="text-center text-white">
            <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-4"></div>
            <h2 class="text-xl font-semibold">Î¶¨Ìè¨Ìä∏ Î°úÎî© Ï§ë...</h2>
            <p class="mt-2 opacity-80">Îç∞Ïù¥ÌÑ∞Î•º Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§</p>
        </div>
    </div>

    <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
    <div id="main-content" class="hidden">
        <!-- Ìó§Îçî -->
        <header class="gradient-bg text-white py-6 px-4">
            <div class="container mx-auto text-center">
                <h1 class="text-3xl font-bold mb-2">üë£ 3D Î∞ú Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</h1>
                <p class="opacity-90" id="analysis-date">Î∂ÑÏÑù ÏôÑÎ£å</p>
            </div>
        </header>

        <!-- ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
        <div class="container mx-auto p-4 -mt-4">
            <!-- ÌååÏùº Ï†ïÎ≥¥ Ïπ¥Îìú -->
            <div class="bg-white rounded-xl card-shadow p-6 mb-6">
                <div class="flex items-center mb-4">
                    <div class="bg-blue-100 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">ÌååÏùº Ï†ïÎ≥¥</h2>
                        <p class="text-gray-600">ÏóÖÎ°úÎìúÎêú 3D Î™®Îç∏ Ï†ïÎ≥¥</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-3">
                    <div class="flex justify-between items-center py-2 border-b border-gray-100">
                        <span class="text-gray-600">ÌååÏùºÎ™Ö</span>
                        <span class="font-semibold text-gray-800" id="file-name">-</span>
                    </div>
                    <div class="flex justify-between items-center py-2">
                        <span class="text-gray-600">Î∂ÑÏÑù ÏôÑÎ£å</span>
                        <span class="font-semibold text-gray-800" id="analysis-time">-</span>
                    </div>
                </div>
            </div>

            <!-- Ï∏°Ï†ï Îç∞Ïù¥ÌÑ∞ Ïπ¥Îìú -->
            <div class="measurement-card rounded-xl card-shadow p-6 mb-6 text-white">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold">Ï†ïÎ∞Ä Ï∏°Ï†ï Îç∞Ïù¥ÌÑ∞</h2>
                        <p class="opacity-90">3D Ïä§Ï∫î Í∏∞Î∞ò Ï†ïÌôïÌïú Ï∏°Ï†ï Í≤∞Í≥º</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-4">
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm opacity-90">üë£ Î∞ú Í∏∏Ïù¥ (Ï°±Ïû•)</span>
                            <span class="text-2xl font-bold" id="foot-length">- mm</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full transition-all duration-1000" id="length-bar"></div>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm opacity-90">‚ÜîÔ∏è Î∞úÎ≥º ÎÑàÎπÑ (Ï°±Ìè≠)</span>
                            <span class="text-2xl font-bold" id="foot-width">- mm</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full transition-all duration-1000" id="width-bar"></div>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm opacity-90">‚ÜïÔ∏è Î∞úÎì± ÎÜíÏù¥</span>
                            <span class="text-2xl font-bold" id="foot-height">- mm</span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-2">
                            <div class="bg-white h-2 rounded-full transition-all duration-1000" id="height-bar"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-white bg-opacity-10 rounded-lg">
                    <div class="flex items-center justify-between">
                        <span class="text-sm opacity-90">Ï∏°Ï†ï Ïã†Î¢∞ÎèÑ</span>
                        <span class="font-semibold" id="confidence-level">ÎÜíÏùå</span>
                    </div>
                </div>
            </div>

            <!-- ÎπÑÏú® Î∂ÑÏÑù Ïπ¥Îìú -->
            <div class="bg-white rounded-xl card-shadow p-6 mb-6">
                <div class="flex items-center mb-4">
                    <div class="bg-purple-100 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">ÎπÑÏú® Î∂ÑÏÑù</h2>
                        <p class="text-gray-600">Î∞úÏùò Í∑†ÌòïÍ≥º ÎπÑÎ°Ä Î∂ÑÏÑù</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-purple-600 mb-2" id="length-width-ratio">2.4</div>
                        <div class="text-sm text-gray-600">Í∏∏Ïù¥/ÎÑàÎπÑ ÎπÑÏú®</div>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-purple-600 mb-2" id="height-length-ratio">20%</div>
                        <div class="text-sm text-gray-600">ÎÜíÏù¥/Í∏∏Ïù¥ ÎπÑÏú®</div>
                    </div>
                </div>
            </div>

            <!-- Î∞ú Ïú†Ìòï Î∂ÑÏÑù Ïπ¥Îìú -->
            <div class="analysis-card rounded-xl card-shadow p-6 mb-6 text-white">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold">Î∞ú Ïú†Ìòï Ï¢ÖÌï© Î∂ÑÏÑù</h2>
                        <p class="opacity-90">AI Í∏∞Î∞ò ÎßûÏ∂§Ìòï Î∞ú Ïú†Ìòï Î∂ÑÏÑù</p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm opacity-90">Î∞ú ÌòïÌÉú</span>
                            <span class="font-bold text-lg" id="foot-type">ÌëúÏ§ÄÌòï</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm opacity-90">ÏïÑÏπò Ïú†Ìòï</span>
                            <span class="font-bold text-lg" id="arch-type">Ï†ïÏÉÅ ÏïÑÏπò</span>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <p class="text-sm opacity-90 mb-2">ÌäπÏßï</p>
                        <p id="foot-description">Í∑†ÌòïÏû°Ìûå ÎπÑÎ°ÄÎ•º Í∞ÄÏßÑ ÌëúÏ§ÄÏ†ÅÏù∏ Î∞ú ÌòïÌÉúÏûÖÎãàÎã§.</p>
                    </div>
                </div>
            </div>

            <!-- Ï∂îÏ≤ú ÏÇ¨Ìï≠ Ïπ¥Îìú -->
            <div class="recommendation-card rounded-xl card-shadow p-6 mb-6 text-white">
                <div class="flex items-center mb-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold">ÎßûÏ∂§Ìòï Ïã†Î∞ú Ï∂îÏ≤ú</h2>
                        <p class="opacity-90">Î∞ú Ïú†ÌòïÏóê Îî∞Î•∏ Ï†ÑÎ¨∏Í∞Ä Ï∂îÏ≤úÏÇ¨Ìï≠</p>
                    </div>
                </div>
                <div id="recommendations-list" class="space-y-3">
                    <!-- Ï∂îÏ≤úÏÇ¨Ìï≠Ïù¥ ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>

            <!-- Ïï°ÏÖò Î≤ÑÌäº -->
            <div class="no-print space-y-3 mb-8">
                <button onclick="downloadPDF()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    üìÑ PDF Îã§Ïö¥Î°úÎìú
                </button>
                <button onclick="shareReport()" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                    </svg>
                    üì± Î¶¨Ìè¨Ìä∏ Í≥µÏú†
                </button>
                <button onclick="window.print()" class="w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    üñ®Ô∏è Ïù∏ÏáÑÌïòÍ∏∞
                </button>
            </div>

            <!-- Ìë∏ÌÑ∞ -->
            <footer class="text-center text-gray-500 text-sm py-6 border-t">
                <p>¬© 2024 3D Î∞ú Î∂ÑÏÑùÍ∏∞ | Ï†ïÎ∞Ä Ï∏°Ï†ï ÏãúÏä§ÌÖú</p>
                <p class="mt-1">Ïù¥ Î¶¨Ìè¨Ìä∏Îäî 3D Ïä§Ï∫î Îç∞Ïù¥ÌÑ∞Î•º Í∏∞Î∞òÏúºÎ°ú ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.</p>
            </footer>
        </div>
    </div>

    <!-- jsPDF ÎùºÏù¥Î∏åÎü¨Î¶¨ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        let reportData = null;

        // ÌéòÏù¥ÏßÄ Î°úÎìúÏãú Ïã§Ìñâ
        document.addEventListener('DOMContentLoaded', () => {
            loadReportData();
        });

        function loadReportData() {
            // URL ÌååÎùºÎØ∏ÌÑ∞ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú
            const urlParams = new URLSearchParams(window.location.search);
            const encodedData = urlParams.get('data');
            
            if (encodedData) {
                try {
                    const jsonData = decodeURIComponent(escape(atob(encodedData)));
                    reportData = JSON.parse(jsonData);
                    displayReport(reportData);
                } catch (error) {
                    console.error('Î¶¨Ìè¨Ìä∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                    showError('Î¶¨Ìè¨Ìä∏ Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.');
                }
            } else {
                showError('Î¶¨Ìè¨Ìä∏ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. QR ÏΩîÎìúÎ•º Îã§Ïãú Ïä§Ï∫îÌï¥Ï£ºÏÑ∏Ïöî.');
            }
        }

        function displayReport(data) {
            setTimeout(() => {
                // Î°úÎî© ÌôîÎ©¥ Ïà®Í∏∞Í∏∞
                document.getElementById('loading-screen').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');

                // ÌååÏùº Ï†ïÎ≥¥ ÌëúÏãú
                document.getElementById('file-name').textContent = data.fileName || 'Unknown';
                document.getElementById('analysis-time').textContent = new Date(data.analysisDate).toLocaleString('ko-KR');
                document.getElementById('analysis-date').textContent = 
                    `${new Date(data.analysisDate).toLocaleDateString('ko-KR')} Î∂ÑÏÑù ÏôÑÎ£å`;

                // Ï∏°Ï†ï Îç∞Ïù¥ÌÑ∞ ÌëúÏãú
                const measurements = data.measurements;
                document.getElementById('foot-length').textContent = `${measurements.length} ${measurements.unit}`;
                document.getElementById('foot-width').textContent = `${measurements.width} ${measurements.unit}`;
                document.getElementById('foot-height').textContent = `${measurements.height} ${measurements.unit}`;
                document.getElementById('confidence-level').textContent = measurements.confidence;

                // Ï∏°Ï†ï Î∞î Ïï†ÎãàÎ©îÏù¥ÏÖò
                animateMeasurementBars(measurements);

                // ÎπÑÏú® Î∂ÑÏÑù ÌëúÏãú
                document.getElementById('length-width-ratio').textContent = data.ratios.lengthWidth;
                document.getElementById('height-length-ratio').textContent = data.ratios.heightLength;

                // Î∞ú Ïú†Ìòï Î∂ÑÏÑù ÌëúÏãú
                const analysis = data.analysis;
                document.getElementById('foot-type').textContent = analysis.footType;
                document.getElementById('arch-type').textContent = analysis.archType;
                document.getElementById('foot-description').textContent = analysis.description;

                // Ï∂îÏ≤úÏÇ¨Ìï≠ ÌëúÏãú
                displayRecommendations(data.recommendations);

            }, 1500); // 1.5Ï¥à Î°úÎî© ÏãúÍ∞Ñ
        }

        function animateMeasurementBars(measurements) {
            // ÏµúÎåÄÍ∞íÏùÑ Í∏∞Ï§ÄÏúºÎ°ú Î∞î Í∏∏Ïù¥ Í≥ÑÏÇ∞
            const maxLength = Math.max(
                parseFloat(measurements.length) || 0,
                parseFloat(measurements.width) || 0,
                parseFloat(measurements.height) || 0
            );

            setTimeout(() => {
                const lengthPercent = (parseFloat(measurements.length) / maxLength) * 100;
                const widthPercent = (parseFloat(measurements.width) / maxLength) * 100;
                const heightPercent = (parseFloat(measurements.height) / maxLength) * 100;

                document.getElementById('length-bar').style.width = `${lengthPercent}%`;
                document.getElementById('width-bar').style.width = `${widthPercent}%`;
                document.getElementById('height-bar').style.width = `${heightPercent}%`;
            }, 500);
        }

        function displayRecommendations(recommendations) {
            const container = document.getElementById('recommendations-list');
            container.innerHTML = '';

            recommendations.forEach((rec, index) => {
                const div = document.createElement('div');
                div.className = 'bg-white bg-opacity-10 rounded-lg p-4 transform transition-all duration-500';
                div.style.animationDelay = `${index * 200}ms`;
                div.innerHTML = `
                    <div class="flex items-start">
                        <div class="bg-white bg-opacity-20 rounded-full p-2 mr-3 mt-1">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <p class="text-sm leading-relaxed">${rec}</p>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function showError(message) {
            document.getElementById('loading-screen').classList.add('hidden');
            document.getElementById('main-content').innerHTML = `
                <div class="container mx-auto p-4 text-center">
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
                        <h2 class="text-xl font-bold mb-2">Ïò§Î•ò Î∞úÏÉù</h2>
                        <p>${message}</p>
                    </div>
                </div>
            `;
            document.getElementById('main-content').classList.remove('hidden');
        }

        function downloadPDF() {
            if (!reportData) {
                alert('Î¶¨Ìè¨Ìä∏ Îç∞Ïù¥ÌÑ∞Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // PDF ÏÉùÏÑ±
            doc.setFont('helvetica');
            
            // Ï†úÎ™©
            doc.setFontSize(20);
            doc.text('3D Foot Analysis Report', 20, 30);
            
            // ÌååÏùº Ï†ïÎ≥¥
            doc.setFontSize(12);
            doc.text(`File: ${reportData.fileName}`, 20, 50);
            doc.text(`Analysis Date: ${new Date(reportData.analysisDate).toLocaleDateString('ko-KR')}`, 20, 60);
            
            // Ï∏°Ï†ï Îç∞Ïù¥ÌÑ∞
            doc.setFontSize(16);
            doc.text('Measurement Data', 20, 80);
            
            doc.setFontSize(12);
            const measurements = [
                `Foot Length: ${reportData.measurements.length} ${reportData.measurements.unit}`,
                `Foot Width: ${reportData.measurements.width} ${reportData.measurements.unit}`,
                `Foot Height: ${reportData.measurements.height} ${reportData.measurements.unit}`,
                `Confidence: ${reportData.measurements.confidence}`
            ];
            
            let yPos = 100;
            measurements.forEach(measurement => {
                doc.text(measurement, 20, yPos);
                yPos += 15;
            });
            
            // ÎπÑÏú® Î∂ÑÏÑù
            doc.setFontSize(16);
            doc.text('Ratio Analysis', 20, yPos + 10);
            yPos += 30;
            
            doc.setFontSize(12);
            doc.text(`Length/Width Ratio: ${reportData.ratios.lengthWidth}`, 20, yPos);
            doc.text(`Height/Length Ratio: ${reportData.ratios.heightLength}`, 20, yPos + 15);
            yPos += 40;
            
            // Î∞ú Ïú†Ìòï Î∂ÑÏÑù
            doc.setFontSize(16);
            doc.text('Foot Type Analysis', 20, yPos);
            yPos += 20;
            
            doc.setFontSize(12);
            doc.text(`Foot Shape: ${reportData.analysis.footType}`, 20, yPos);
            doc.text(`Arch Type: ${reportData.analysis.archType}`, 20, yPos + 15);
            doc.text(`Description: ${reportData.analysis.description}`, 20, yPos + 30);
            yPos += 50;
            
            // Ï∂îÏ≤ú ÏÇ¨Ìï≠
            doc.setFontSize(16);
            doc.text('Recommendations', 20, yPos);
            yPos += 20;
            
            doc.setFontSize(10);
            reportData.recommendations.forEach(rec => {
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 20;
                }
                doc.text(`‚Ä¢ ${rec}`, 20, yPos);
                yPos += 12;
            });
            
            // PDF Ï†ÄÏû•
            const fileName = `foot_analysis_mobile_${new Date().toISOString().slice(0, 10)}.pdf`;
            doc.save(fileName);
        }

        function shareReport() {
            if (navigator.share) {
                navigator.share({
                    title: '3D Î∞ú Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏',
                    text: 'ÎÇ¥ Î∞úÏùò Ï†ïÎ∞Ä Ï∏°Ï†ï Í≤∞Í≥ºÎ•º ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî!',
                    url: window.location.href
                }).catch(console.error);
            } else {
                // Ìè¥Î∞±: URL Î≥µÏÇ¨
                navigator.clipboard.writeText(window.location.href).then(() => {
                    alert('Î¶¨Ìè¨Ìä∏ ÎßÅÌÅ¨Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
                }).catch(() => {
                    // ÌÅ¥Î¶ΩÎ≥¥Îìú APIÍ∞Ä ÏßÄÏõêÎêòÏßÄ ÏïäÎäî Í≤ΩÏö∞
                    const textArea = document.createElement('textarea');
                    textArea.value = window.location.href;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('Î¶¨Ìè¨Ìä∏ ÎßÅÌÅ¨Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
                });
            }
        }

        // Ïù∏ÏáÑ ÏµúÏ†ÅÌôî
        window.addEventListener('beforeprint', () => {
            document.body.classList.add('print-mode');
        });

        window.addEventListener('afterprint', () => {
            document.body.classList.remove('print-mode');
        });

        // PWA Í¥ÄÎ†® Í∏∞Îä•
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(registrationError => console.log('SW registration failed'));
            });
        }

        // Îã§ÌÅ¨Î™®Îìú ÏßÄÏõê
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
    </script>

</body>
</html> 